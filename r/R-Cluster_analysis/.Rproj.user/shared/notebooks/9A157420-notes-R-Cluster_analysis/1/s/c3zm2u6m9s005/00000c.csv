"0","library(purrr)"
"0","library(cluster)"
"0",""
"0","# Use map_dbl to run many models with varying value of k (centers)"
"0","tot_withinss <- map_dbl(1:10,  function(k){"
"0","  model <- kmeans(x = oes, centers = k)"
"0","  model$tot.withinss"
"0","})"
"0",""
"0","# Generate a data frame containing both k and tot_withinss"
"0","elbow_df <- data.frame("
"0","  k = 1:10,"
"0","  tot_withinss = tot_withinss"
"0",")"
"0",""
"0","# Plot the elbow plot"
"0","ggplot(elbow_df, aes(x = k, y = tot_withinss)) +"
"0","  geom_line() +"
"0","  scale_x_continuous(breaks = 1:10) +"
"0","  theme_classic() +"
"0","  labs(title = ""Elbow Analysis for K-means"")"
